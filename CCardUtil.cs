using System;

namespace NFCKbd
{
    public class CCardUtil
    {
        protected static string[] m_str;

        protected static uint[] m_table0_0;

        protected static uint[] m_table0_1;

        protected static uint[] m_table0_2;

        protected static uint[] m_table0_3;

        protected static uint[] m_table0_4;

        protected static uint[] m_table0_5;

        protected static uint[] m_table0_6;

        protected static uint[] m_table0_7;

        protected static uint[,] m_table1;

        static CCardUtil()
        {
            m_table0_0 = new uint[64];
            m_table0_0[0] = 34078728u;
            m_table0_0[1] = 34086912u;
            m_table0_0[2] = 8200u;
            m_table0_0[3] = 0u;
            m_table0_0[4] = 33562624u;
            m_table0_0[5] = 524296u;
            m_table0_0[6] = 34078720u;
            m_table0_0[7] = 34086920u;
            m_table0_0[8] = 8u;
            m_table0_0[9] = 33554432u;
            m_table0_0[10] = 532480u;
            m_table0_0[11] = 8200u;
            m_table0_0[12] = 532488u;
            m_table0_0[13] = 33562632u;
            m_table0_0[14] = 33554440u;
            m_table0_0[15] = 34078720u;
            m_table0_0[16] = 8192u;
            m_table0_0[17] = 532488u;
            m_table0_0[18] = 524296u;
            m_table0_0[19] = 33562624u;
            m_table0_0[20] = 34086920u;
            m_table0_0[21] = 33554440u;
            m_table0_0[22] = 0u;
            m_table0_0[23] = 532480u;
            m_table0_0[24] = 33554432u;
            m_table0_0[25] = 524288u;
            m_table0_0[26] = 33562632u;
            m_table0_0[27] = 34078728u;
            m_table0_0[28] = 524288u;
            m_table0_0[29] = 8192u;
            m_table0_0[30] = 34086912u;
            m_table0_0[31] = 8u;
            m_table0_0[32] = 524288u;
            m_table0_0[33] = 8192u;
            m_table0_0[34] = 33554440u;
            m_table0_0[35] = 34086920u;
            m_table0_0[36] = 8200u;
            m_table0_0[37] = 33554432u;
            m_table0_0[38] = 0u;
            m_table0_0[39] = 532480u;
            m_table0_0[40] = 34078728u;
            m_table0_0[41] = 33562632u;
            m_table0_0[42] = 33562624u;
            m_table0_0[43] = 524296u;
            m_table0_0[44] = 34086912u;
            m_table0_0[45] = 8u;
            m_table0_0[46] = 524296u;
            m_table0_0[47] = 33562624u;
            m_table0_0[48] = 34086920u;
            m_table0_0[49] = 524288u;
            m_table0_0[50] = 34078720u;
            m_table0_0[51] = 33554440u;
            m_table0_0[52] = 532480u;
            m_table0_0[53] = 8200u;
            m_table0_0[54] = 33562632u;
            m_table0_0[55] = 34078720u;
            m_table0_0[56] = 8u;
            m_table0_0[57] = 34086912u;
            m_table0_0[58] = 532488u;
            m_table0_0[59] = 0u;
            m_table0_0[60] = 33554432u;
            m_table0_0[61] = 34078728u;
            m_table0_0[62] = 8192u;
            m_table0_0[63] = 532488u;
            m_table0_1 = new uint[64];
            m_table0_1[0] = 134217732u;
            m_table0_1[1] = 131076u;
            m_table0_1[2] = 0u;
            m_table0_1[3] = 134349312u;
            m_table0_1[4] = 131076u;
            m_table0_1[5] = 512u;
            m_table0_1[6] = 134218244u;
            m_table0_1[7] = 131072u;
            m_table0_1[8] = 516u;
            m_table0_1[9] = 134349316u;
            m_table0_1[10] = 131584u;
            m_table0_1[11] = 134217728u;
            m_table0_1[12] = 134218240u;
            m_table0_1[13] = 134217732u;
            m_table0_1[14] = 134348800u;
            m_table0_1[15] = 131588u;
            m_table0_1[16] = 131072u;
            m_table0_1[17] = 134218244u;
            m_table0_1[18] = 134348804u;
            m_table0_1[19] = 0u;
            m_table0_1[20] = 512u;
            m_table0_1[21] = 4u;
            m_table0_1[22] = 134349312u;
            m_table0_1[23] = 134348804u;
            m_table0_1[24] = 134349316u;
            m_table0_1[25] = 134348800u;
            m_table0_1[26] = 134217728u;
            m_table0_1[27] = 516u;
            m_table0_1[28] = 4u;
            m_table0_1[29] = 131584u;
            m_table0_1[30] = 131588u;
            m_table0_1[31] = 134218240u;
            m_table0_1[32] = 516u;
            m_table0_1[33] = 134217728u;
            m_table0_1[34] = 134218240u;
            m_table0_1[35] = 131588u;
            m_table0_1[36] = 134349312u;
            m_table0_1[37] = 131076u;
            m_table0_1[38] = 0u;
            m_table0_1[39] = 134218240u;
            m_table0_1[40] = 134217728u;
            m_table0_1[41] = 512u;
            m_table0_1[42] = 134348804u;
            m_table0_1[43] = 131072u;
            m_table0_1[44] = 131076u;
            m_table0_1[45] = 134349316u;
            m_table0_1[46] = 131584u;
            m_table0_1[47] = 4u;
            m_table0_1[48] = 134349316u;
            m_table0_1[49] = 131584u;
            m_table0_1[50] = 131072u;
            m_table0_1[51] = 134218244u;
            m_table0_1[52] = 134217732u;
            m_table0_1[53] = 134348800u;
            m_table0_1[54] = 131588u;
            m_table0_1[55] = 0u;
            m_table0_1[56] = 512u;
            m_table0_1[57] = 134217732u;
            m_table0_1[58] = 134218244u;
            m_table0_1[59] = 134349312u;
            m_table0_1[60] = 134348800u;
            m_table0_1[61] = 516u;
            m_table0_1[62] = 4u;
            m_table0_1[63] = 134348804u;
            m_table0_2 = new uint[64];
            m_table0_2[0] = 2147746048u;
            m_table0_2[1] = 16777472u;
            m_table0_2[2] = 2147483648u;
            m_table0_2[3] = 2164523264u;
            m_table0_2[4] = 0u;
            m_table0_2[5] = 17039360u;
            m_table0_2[6] = 2164261120u;
            m_table0_2[7] = 2147745792u;
            m_table0_2[8] = 17039616u;
            m_table0_2[9] = 2164260864u;
            m_table0_2[10] = 16777216u;
            m_table0_2[11] = 2147483904u;
            m_table0_2[12] = 2164260864u;
            m_table0_2[13] = 2147746048u;
            m_table0_2[14] = 262144u;
            m_table0_2[15] = 16777216u;
            m_table0_2[16] = 2164523008u;
            m_table0_2[17] = 262400u;
            m_table0_2[18] = 256u;
            m_table0_2[19] = 2147483648u;
            m_table0_2[20] = 262400u;
            m_table0_2[21] = 2164261120u;
            m_table0_2[22] = 17039360u;
            m_table0_2[23] = 256u;
            m_table0_2[24] = 2147483904u;
            m_table0_2[25] = 0u;
            m_table0_2[26] = 2147745792u;
            m_table0_2[27] = 17039616u;
            m_table0_2[28] = 16777472u;
            m_table0_2[29] = 2164523008u;
            m_table0_2[30] = 2164523264u;
            m_table0_2[31] = 262144u;
            m_table0_2[32] = 2164523008u;
            m_table0_2[33] = 2147483904u;
            m_table0_2[34] = 262144u;
            m_table0_2[35] = 2164260864u;
            m_table0_2[36] = 262400u;
            m_table0_2[37] = 16777472u;
            m_table0_2[38] = 2147483648u;
            m_table0_2[39] = 17039360u;
            m_table0_2[40] = 2164261120u;
            m_table0_2[41] = 0u;
            m_table0_2[42] = 256u;
            m_table0_2[43] = 2147745792u;
            m_table0_2[44] = 0u;
            m_table0_2[45] = 2164523008u;
            m_table0_2[46] = 17039616u;
            m_table0_2[47] = 256u;
            m_table0_2[48] = 16777216u;
            m_table0_2[49] = 2164523264u;
            m_table0_2[50] = 2147746048u;
            m_table0_2[51] = 262144u;
            m_table0_2[52] = 2164523264u;
            m_table0_2[53] = 2147483648u;
            m_table0_2[54] = 16777472u;
            m_table0_2[55] = 2147746048u;
            m_table0_2[56] = 2147745792u;
            m_table0_2[57] = 262400u;
            m_table0_2[58] = 17039360u;
            m_table0_2[59] = 2164261120u;
            m_table0_2[60] = 2147483904u;
            m_table0_2[61] = 16777216u;
            m_table0_2[62] = 2164260864u;
            m_table0_2[63] = 17039616u;
            m_table0_3 = new uint[64];
            m_table0_3[0] = 67176449u;
            m_table0_3[1] = 0u;
            m_table0_3[2] = 67584u;
            m_table0_3[3] = 67174400u;
            m_table0_3[4] = 67108865u;
            m_table0_3[5] = 2049u;
            m_table0_3[6] = 67110912u;
            m_table0_3[7] = 67584u;
            m_table0_3[8] = 2048u;
            m_table0_3[9] = 67174401u;
            m_table0_3[10] = 1u;
            m_table0_3[11] = 67110912u;
            m_table0_3[12] = 65537u;
            m_table0_3[13] = 67176448u;
            m_table0_3[14] = 67174400u;
            m_table0_3[15] = 1u;
            m_table0_3[16] = 65536u;
            m_table0_3[17] = 67110913u;
            m_table0_3[18] = 67174401u;
            m_table0_3[19] = 2048u;
            m_table0_3[20] = 67585u;
            m_table0_3[21] = 67108864u;
            m_table0_3[22] = 0u;
            m_table0_3[23] = 65537u;
            m_table0_3[24] = 67110913u;
            m_table0_3[25] = 67585u;
            m_table0_3[26] = 67176448u;
            m_table0_3[27] = 67108865u;
            m_table0_3[28] = 67108864u;
            m_table0_3[29] = 65536u;
            m_table0_3[30] = 2049u;
            m_table0_3[31] = 67176449u;
            m_table0_3[32] = 65537u;
            m_table0_3[33] = 67176448u;
            m_table0_3[34] = 67110912u;
            m_table0_3[35] = 67585u;
            m_table0_3[36] = 67176449u;
            m_table0_3[37] = 65537u;
            m_table0_3[38] = 67108865u;
            m_table0_3[39] = 0u;
            m_table0_3[40] = 67108864u;
            m_table0_3[41] = 2049u;
            m_table0_3[42] = 65536u;
            m_table0_3[43] = 67174401u;
            m_table0_3[44] = 2048u;
            m_table0_3[45] = 67108864u;
            m_table0_3[46] = 67585u;
            m_table0_3[47] = 67110913u;
            m_table0_3[48] = 67176448u;
            m_table0_3[49] = 2048u;
            m_table0_3[50] = 0u;
            m_table0_3[51] = 67108865u;
            m_table0_3[52] = 1u;
            m_table0_3[53] = 67176449u;
            m_table0_3[54] = 67584u;
            m_table0_3[55] = 67174400u;
            m_table0_3[56] = 67174401u;
            m_table0_3[57] = 65536u;
            m_table0_3[58] = 2049u;
            m_table0_3[59] = 67110912u;
            m_table0_3[60] = 67110913u;
            m_table0_3[61] = 1u;
            m_table0_3[62] = 67174400u;
            m_table0_3[63] = 67584u;
            m_table0_4 = new uint[64];
            m_table0_4[0] = 1024u;
            m_table0_4[1] = 32u;
            m_table0_4[2] = 1048608u;
            m_table0_4[3] = 1074790400u;
            m_table0_4[4] = 1074791456u;
            m_table0_4[5] = 1073742848u;
            m_table0_4[6] = 1056u;
            m_table0_4[7] = 0u;
            m_table0_4[8] = 1048576u;
            m_table0_4[9] = 1074790432u;
            m_table0_4[10] = 1073741856u;
            m_table0_4[11] = 1049600u;
            m_table0_4[12] = 1073741824u;
            m_table0_4[13] = 1049632u;
            m_table0_4[14] = 1049600u;
            m_table0_4[15] = 1073741856u;
            m_table0_4[16] = 1074790432u;
            m_table0_4[17] = 1024u;
            m_table0_4[18] = 1073742848u;
            m_table0_4[19] = 1074791456u;
            m_table0_4[20] = 0u;
            m_table0_4[21] = 1048608u;
            m_table0_4[22] = 1074790400u;
            m_table0_4[23] = 1056u;
            m_table0_4[24] = 1074791424u;
            m_table0_4[25] = 1073742880u;
            m_table0_4[26] = 1049632u;
            m_table0_4[27] = 1073741824u;
            m_table0_4[28] = 1073742880u;
            m_table0_4[29] = 1074791424u;
            m_table0_4[30] = 32u;
            m_table0_4[31] = 1048576u;
            m_table0_4[32] = 1073742880u;
            m_table0_4[33] = 1049600u;
            m_table0_4[34] = 1074791424u;
            m_table0_4[35] = 1073741856u;
            m_table0_4[36] = 1024u;
            m_table0_4[37] = 32u;
            m_table0_4[38] = 1048576u;
            m_table0_4[39] = 1074791424u;
            m_table0_4[40] = 1074790432u;
            m_table0_4[41] = 1073742880u;
            m_table0_4[42] = 1056u;
            m_table0_4[43] = 0u;
            m_table0_4[44] = 32u;
            m_table0_4[45] = 1074790400u;
            m_table0_4[46] = 1073741824u;
            m_table0_4[47] = 1048608u;
            m_table0_4[48] = 0u;
            m_table0_4[49] = 1074790432u;
            m_table0_4[50] = 1048608u;
            m_table0_4[51] = 1056u;
            m_table0_4[52] = 1073741856u;
            m_table0_4[53] = 1024u;
            m_table0_4[54] = 1074791456u;
            m_table0_4[55] = 1048576u;
            m_table0_4[56] = 1049632u;
            m_table0_4[57] = 1073741824u;
            m_table0_4[58] = 1073742848u;
            m_table0_4[59] = 1074791456u;
            m_table0_4[60] = 1074790400u;
            m_table0_4[61] = 1049632u;
            m_table0_4[62] = 1049600u;
            m_table0_4[63] = 1073742848u;
            m_table0_5 = new uint[64];
            m_table0_5[0] = 8388608u;
            m_table0_5[1] = 4096u;
            m_table0_5[2] = 64u;
            m_table0_5[3] = 8392770u;
            m_table0_5[4] = 8392706u;
            m_table0_5[5] = 8388672u;
            m_table0_5[6] = 4162u;
            m_table0_5[7] = 8392704u;
            m_table0_5[8] = 4096u;
            m_table0_5[9] = 2u;
            m_table0_5[10] = 8388610u;
            m_table0_5[11] = 4160u;
            m_table0_5[12] = 8388674u;
            m_table0_5[13] = 8392706u;
            m_table0_5[14] = 8392768u;
            m_table0_5[15] = 0u;
            m_table0_5[16] = 4160u;
            m_table0_5[17] = 8388608u;
            m_table0_5[18] = 4098u;
            m_table0_5[19] = 66u;
            m_table0_5[20] = 8388672u;
            m_table0_5[21] = 4162u;
            m_table0_5[22] = 0u;
            m_table0_5[23] = 8388610u;
            m_table0_5[24] = 2u;
            m_table0_5[25] = 8388674u;
            m_table0_5[26] = 8392770u;
            m_table0_5[27] = 4098u;
            m_table0_5[28] = 8392704u;
            m_table0_5[29] = 64u;
            m_table0_5[30] = 66u;
            m_table0_5[31] = 8392768u;
            m_table0_5[32] = 8392768u;
            m_table0_5[33] = 8388674u;
            m_table0_5[34] = 4098u;
            m_table0_5[35] = 8392704u;
            m_table0_5[36] = 4096u;
            m_table0_5[37] = 2u;
            m_table0_5[38] = 8388610u;
            m_table0_5[39] = 8388672u;
            m_table0_5[40] = 8388608u;
            m_table0_5[41] = 4160u;
            m_table0_5[42] = 8392770u;
            m_table0_5[43] = 0u;
            m_table0_5[44] = 4162u;
            m_table0_5[45] = 8388608u;
            m_table0_5[46] = 64u;
            m_table0_5[47] = 4098u;
            m_table0_5[48] = 8388674u;
            m_table0_5[49] = 64u;
            m_table0_5[50] = 0u;
            m_table0_5[51] = 8392770u;
            m_table0_5[52] = 8392706u;
            m_table0_5[53] = 8392768u;
            m_table0_5[54] = 66u;
            m_table0_5[55] = 4096u;
            m_table0_5[56] = 4160u;
            m_table0_5[57] = 8392706u;
            m_table0_5[58] = 8388672u;
            m_table0_5[59] = 66u;
            m_table0_5[60] = 2u;
            m_table0_5[61] = 4162u;
            m_table0_5[62] = 8392704u;
            m_table0_5[63] = 8388610u;
            m_table0_6 = new uint[64];
            m_table0_6[0] = 272629760u;
            m_table0_6[1] = 4210704u;
            m_table0_6[2] = 16u;
            m_table0_6[3] = 272629776u;
            m_table0_6[4] = 268451840u;
            m_table0_6[5] = 4194304u;
            m_table0_6[6] = 272629776u;
            m_table0_6[7] = 16400u;
            m_table0_6[8] = 4194320u;
            m_table0_6[9] = 16384u;
            m_table0_6[10] = 4210688u;
            m_table0_6[11] = 268435456u;
            m_table0_6[12] = 272646160u;
            m_table0_6[13] = 268435472u;
            m_table0_6[14] = 268435456u;
            m_table0_6[15] = 272646144u;
            m_table0_6[16] = 0u;
            m_table0_6[17] = 268451840u;
            m_table0_6[18] = 4210704u;
            m_table0_6[19] = 16u;
            m_table0_6[20] = 268435472u;
            m_table0_6[21] = 272646160u;
            m_table0_6[22] = 16384u;
            m_table0_6[23] = 272629760u;
            m_table0_6[24] = 272646144u;
            m_table0_6[25] = 4194320u;
            m_table0_6[26] = 268451856u;
            m_table0_6[27] = 4210688u;
            m_table0_6[28] = 16400u;
            m_table0_6[29] = 0u;
            m_table0_6[30] = 4194304u;
            m_table0_6[31] = 268451856u;
            m_table0_6[32] = 4210704u;
            m_table0_6[33] = 16u;
            m_table0_6[34] = 268435456u;
            m_table0_6[35] = 16384u;
            m_table0_6[36] = 268435472u;
            m_table0_6[37] = 268451840u;
            m_table0_6[38] = 4210688u;
            m_table0_6[39] = 272629776u;
            m_table0_6[40] = 0u;
            m_table0_6[41] = 4210704u;
            m_table0_6[42] = 16400u;
            m_table0_6[43] = 272646144u;
            m_table0_6[44] = 268451840u;
            m_table0_6[45] = 4194304u;
            m_table0_6[46] = 272646160u;
            m_table0_6[47] = 268435456u;
            m_table0_6[48] = 268451856u;
            m_table0_6[49] = 272629760u;
            m_table0_6[50] = 4194304u;
            m_table0_6[51] = 272646160u;
            m_table0_6[52] = 16384u;
            m_table0_6[53] = 4194320u;
            m_table0_6[54] = 272629776u;
            m_table0_6[55] = 16400u;
            m_table0_6[56] = 4194320u;
            m_table0_6[57] = 0u;
            m_table0_6[58] = 272646144u;
            m_table0_6[59] = 268435472u;
            m_table0_6[60] = 272629760u;
            m_table0_6[61] = 268451856u;
            m_table0_6[62] = 16u;
            m_table0_6[63] = 4210688u;
            m_table0_7 = new uint[64];
            m_table0_7[0] = 2130048u;
            m_table0_7[1] = 32768u;
            m_table0_7[2] = 538968064u;
            m_table0_7[3] = 539000960u;
            m_table0_7[4] = 2097152u;
            m_table0_7[5] = 536903808u;
            m_table0_7[6] = 536903680u;
            m_table0_7[7] = 538968064u;
            m_table0_7[8] = 536903808u;
            m_table0_7[9] = 2130048u;
            m_table0_7[10] = 2129920u;
            m_table0_7[11] = 536871040u;
            m_table0_7[12] = 538968192u;
            m_table0_7[13] = 2097152u;
            m_table0_7[14] = 0u;
            m_table0_7[15] = 536903680u;
            m_table0_7[16] = 32768u;
            m_table0_7[17] = 536870912u;
            m_table0_7[18] = 2097280u;
            m_table0_7[19] = 32896u;
            m_table0_7[20] = 539000960u;
            m_table0_7[21] = 2129920u;
            m_table0_7[22] = 536871040u;
            m_table0_7[23] = 2097280u;
            m_table0_7[24] = 536870912u;
            m_table0_7[25] = 128u;
            m_table0_7[26] = 32896u;
            m_table0_7[27] = 539000832u;
            m_table0_7[28] = 128u;
            m_table0_7[29] = 538968192u;
            m_table0_7[30] = 539000832u;
            m_table0_7[31] = 0u;
            m_table0_7[32] = 0u;
            m_table0_7[33] = 539000960u;
            m_table0_7[34] = 2097280u;
            m_table0_7[35] = 536903680u;
            m_table0_7[36] = 2130048u;
            m_table0_7[37] = 32768u;
            m_table0_7[38] = 536871040u;
            m_table0_7[39] = 2097280u;
            m_table0_7[40] = 539000832u;
            m_table0_7[41] = 128u;
            m_table0_7[42] = 32896u;
            m_table0_7[43] = 538968064u;
            m_table0_7[44] = 536903808u;
            m_table0_7[45] = 536870912u;
            m_table0_7[46] = 538968064u;
            m_table0_7[47] = 2129920u;
            m_table0_7[48] = 539000960u;
            m_table0_7[49] = 32896u;
            m_table0_7[50] = 2129920u;
            m_table0_7[51] = 538968192u;
            m_table0_7[52] = 2097152u;
            m_table0_7[53] = 536871040u;
            m_table0_7[54] = 536903680u;
            m_table0_7[55] = 0u;
            m_table0_7[56] = 32768u;
            m_table0_7[57] = 2097152u;
            m_table0_7[58] = 538968192u;
            m_table0_7[59] = 2130048u;
            m_table0_7[60] = 536870912u;
            m_table0_7[61] = 539000832u;
            m_table0_7[62] = 128u;
            m_table0_7[63] = 536903808u;
            m_table1 = new uint[3, 32];
            m_table1[0, 0] = 550555708u;
            m_table1[0, 1] = 2257505089u;
            m_table1[0, 2] = 3168312452u;
            m_table1[0, 3] = 1275989261u;
            m_table1[0, 4] = 2231120044u;
            m_table1[0, 5] = 1287751950u;
            m_table1[0, 6] = 4233369764u;
            m_table1[0, 7] = 46468932u;
            m_table1[0, 8] = 1756148960u;
            m_table1[0, 9] = 114117198u;
            m_table1[0, 10] = 3425210476u;
            m_table1[0, 11] = 1326222016u;
            m_table1[0, 12] = 2956764264u;
            m_table1[0, 13] = 2286602180u;
            m_table1[0, 14] = 949260504u;
            m_table1[0, 15] = 3481323202u;
            m_table1[0, 16] = 1490580484u;
            m_table1[0, 17] = 3297690692u;
            m_table1[0, 18] = 3035118672u;
            m_table1[0, 19] = 1233977671u;
            m_table1[0, 20] = 1693734080u;
            m_table1[0, 21] = 1279721928u;
            m_table1[0, 22] = 3962580164u;
            m_table1[0, 23] = 3335080385u;
            m_table1[0, 24] = 3360424176u;
            m_table1[0, 25] = 3452717516u;
            m_table1[0, 26] = 2285657332u;
            m_table1[0, 27] = 2333068160u;
            m_table1[0, 28] = 1883029680u;
            m_table1[0, 29] = 3414297229u;
            m_table1[0, 30] = 2021674124u;
            m_table1[0, 31] = 1338671886u;
            m_table1[1, 0] = 2161176636u;
            m_table1[1, 1] = 2395492236u;
            m_table1[1, 2] = 2563284044u;
            m_table1[1, 3] = 3356329871u;
            m_table1[1, 4] = 1421644956u;
            m_table1[1, 5] = 3355559374u;
            m_table1[1, 6] = 1955625180u;
            m_table1[1, 7] = 3284667718u;
            m_table1[1, 8] = 746615024u;
            m_table1[1, 9] = 214846927u;
            m_table1[1, 10] = 2352510180u;
            m_table1[1, 11] = 2370079427u;
            m_table1[1, 12] = 2558307440u;
            m_table1[1, 13] = 3233942213u;
            m_table1[1, 14] = 680328312u;
            m_table1[1, 15] = 3263513544u;
            m_table1[1, 16] = 1284273204u;
            m_table1[1, 17] = 3306049421u;
            m_table1[1, 18] = 2221470900u;
            m_table1[1, 19] = 3410625287u;
            m_table1[1, 20] = 676650136u;
            m_table1[1, 21] = 1212353349u;
            m_table1[1, 22] = 1750662376u;
            m_table1[1, 23] = 1182911817u;
            m_table1[1, 24] = 3494381804u;
            m_table1[1, 25] = 1166872523u;
            m_table1[1, 26] = 3768880356u;
            m_table1[1, 27] = 2282721230u;
            m_table1[1, 28] = 1949612284u;
            m_table1[1, 29] = 3456633486u;
            m_table1[1, 30] = 1482751084u;
            m_table1[1, 31] = 1187546828u;
            m_table1[2, 0] = 3490748580u;
            m_table1[2, 1] = 3456699276u;
            m_table1[2, 2] = 272944172u;
            m_table1[2, 3] = 2257161743u;
            m_table1[2, 4] = 3498089532u;
            m_table1[2, 5] = 1241875983u;
            m_table1[2, 6] = 1421146124u;
            m_table1[2, 7] = 1074300686u;
            m_table1[2, 8] = 343980172u;
            m_table1[2, 9] = 180913487u;
            m_table1[2, 10] = 479212748u;
            m_table1[2, 11] = 138693710u;
            m_table1[2, 12] = 213400676u;
            m_table1[2, 13] = 1103137990u;
            m_table1[2, 14] = 470299744u;
            m_table1[2, 15] = 3234202574u;
            m_table1[2, 16] = 748708956u;
            m_table1[2, 17] = 2172798667u;
            m_table1[2, 18] = 67691604u;
            m_table1[2, 19] = 3309716615u;
            m_table1[2, 20] = 2288024600u;
            m_table1[2, 21] = 3242344839u;
            m_table1[2, 22] = 676101264u;
            m_table1[2, 23] = 3238200585u;
            m_table1[2, 24] = 1078488212u;
            m_table1[2, 25] = 1174620491u;
            m_table1[2, 26] = 3762310372u;
            m_table1[2, 27] = 1091111245u;
            m_table1[2, 28] = 1615084772u;
            m_table1[2, 29] = 1275825037u;
            m_table1[2, 30] = 3763660988u;
            m_table1[2, 31] = 33590921u;
            m_str = new string[32];
            string text = "0";
            m_str[0] = text;
            string text2 = "1";
            m_str[1] = text2;
            string text3 = "2";
            m_str[2] = text3;
            string text4 = "3";
            m_str[3] = text4;
            string text5 = "4";
            m_str[4] = text5;
            string text6 = "5";
            m_str[5] = text6;
            string text7 = "6";
            m_str[6] = text7;
            string text8 = "7";
            m_str[7] = text8;
            string text9 = "8";
            m_str[8] = text9;
            string text10 = "9";
            m_str[9] = text10;
            string text11 = "A";
            m_str[10] = text11;
            string text12 = "B";
            m_str[11] = text12;
            string text13 = "C";
            m_str[12] = text13;
            string text14 = "D";
            m_str[13] = text14;
            string text15 = "E";
            m_str[14] = text15;
            string text16 = "F";
            m_str[15] = text16;
            string text17 = "G";
            m_str[16] = text17;
            string text18 = "H";
            m_str[17] = text18;
            string text19 = "J";
            m_str[18] = text19;
            string text20 = "K";
            m_str[19] = text20;
            string text21 = "L";
            m_str[20] = text21;
            string text22 = "M";
            m_str[21] = text22;
            string text23 = "N";
            m_str[22] = text23;
            string text24 = "P";
            m_str[23] = text24;
            string text25 = "R";
            m_str[24] = text25;
            string text26 = "S";
            m_str[25] = text26;
            string text27 = "T";
            m_str[26] = text27;
            string text28 = "U";
            m_str[27] = text28;
            string text29 = "W";
            m_str[28] = text29;
            string text30 = "X";
            m_str[29] = text30;
            string text31 = "Y";
            m_str[30] = text31;
            string text32 = "Z";
            m_str[31] = text32;
        }

        protected unsafe static void Calc(uint* i, uint* j, int kind)
        {
            uint num = ((*i >> 4) ^ *j) & 0xF0F0F0F;
            *i ^= num << 4;
            *j ^= num;
            ushort num2 = (ushort)(*j >> 16);
            uint num3 = *i & 0xFFFF;
            uint num4 = num2 ^ num3;
            *j ^= num4 << 16;
            *i ^= num4;
            uint num5 = ((*i >> 2) ^ *j) & 0x33333333;
            *i ^= num5 << 2;
            *j ^= num5;
            uint num6 = ((*j >> 8) ^ *i) & 0xFF00FF;
            *j ^= num6 << 8;
            uint num7 = (uint)(*i ^ (int)num6);
            uint num8 = ((*i = ((num7 << 31) | (num7 >> 1))) ^ *j) & 0x55555555;
            *i ^= num8;
            uint num9 = (uint)(*j ^ (int)num8);
            *j = ((num9 << 31) | (num9 >> 1));
            switch (kind)
            {
                case 1:
                    {
                        int num16 = 30;
                        do
                        {
                            uint num17 = m_table1[1, num16 + 1] ^ *j;
                            uint num18 = (num17 >> 28) | (num17 << 4);
                            *i ^= m_table0_7[(num18 >> 2) & 0x3F];
                            *i ^= m_table0_6[(num18 >> 10) & 0x3F];
                            *i ^= m_table0_5[(num18 >> 18) & 0x3F];
                            *i ^= m_table0_4[num18 >> 26];
                            uint num19 = m_table1[1, num16] ^ *j;
                            *i ^= m_table0_3[(num19 >> 2) & 0x3F];
                            *i ^= m_table0_2[(num19 >> 10) & 0x3F];
                            *i ^= m_table0_1[(num19 >> 18) & 0x3F];
                            *i ^= m_table0_0[num19 >> 26];
                            uint num20 = m_table1[1, num16 - 1] ^ *i;
                            uint num21 = (num20 >> 28) | (num20 << 4);
                            *j ^= m_table0_7[(num21 >> 2) & 0x3F];
                            *j ^= m_table0_6[(num21 >> 10) & 0x3F];
                            *j ^= m_table0_5[(num21 >> 18) & 0x3F];
                            *j ^= m_table0_4[num21 >> 26];
                            num8 = (m_table1[1, num16 - 2] ^ *i);
                            *j ^= m_table0_3[(num8 >> 2) & 0x3F];
                            *j ^= m_table0_2[(num8 >> 10) & 0x3F];
                            *j ^= m_table0_1[(num8 >> 18) & 0x3F];
                            *j ^= m_table0_0[num8 >> 26];
                            num16 -= 4;
                        }
                        while (num16 >= 2);
                        break;
                    }
                case 0:
                case 2:
                    {
                        int num10 = 2;
                        do
                        {
                            uint num11 = m_table1[kind, num10 - 2] ^ *j;
                            *i ^= m_table0_3[(num11 >> 2) & 0x3F];
                            *i ^= m_table0_2[(num11 >> 10) & 0x3F];
                            *i ^= m_table0_1[(num11 >> 18) & 0x3F];
                            *i ^= m_table0_0[num11 >> 26];
                            uint num12 = m_table1[kind, num10 - 1] ^ *j;
                            uint num13 = (num12 >> 28) | (num12 << 4);
                            *i ^= m_table0_7[(num13 >> 2) & 0x3F];
                            *i ^= m_table0_6[(num13 >> 10) & 0x3F];
                            *i ^= m_table0_5[(num13 >> 18) & 0x3F];
                            *i ^= m_table0_4[num13 >> 26];
                            uint num14 = m_table1[kind, num10] ^ *i;
                            *j ^= m_table0_3[(num14 >> 2) & 0x3F];
                            *j ^= m_table0_2[(num14 >> 10) & 0x3F];
                            *j ^= m_table0_1[(num14 >> 18) & 0x3F];
                            *j ^= m_table0_0[num14 >> 26];
                            uint num15 = m_table1[kind, num10 + 1] ^ *i;
                            num8 = ((num15 >> 28) | (num15 << 4));
                            *j ^= m_table0_7[(num8 >> 2) & 0x3F];
                            *j ^= m_table0_6[(num8 >> 10) & 0x3F];
                            *j ^= m_table0_5[(num8 >> 18) & 0x3F];
                            *j ^= m_table0_4[num8 >> 26];
                            num10 += 4;
                        }
                        while (num10 <= 30);
                        break;
                    }
            }
            uint num22 = *i;
            uint num23 = ((*i = ((num22 >> 31) | (num22 << 1))) ^ *j) & 0x55555555;
            *i ^= num23;
            uint num24 = (uint)(*j ^ (int)num23);
            uint num25 = *j = ((num24 >> 31) | (num24 << 1));
            uint num26 = ((*i >> 8) ^ num25) & 0xFF00FF;
            *i ^= num26 << 8;
            *j ^= num26;
            uint num27 = ((*j >> 2) ^ *i) & 0x33333333;
            *j ^= num27 << 2;
            *i ^= num27;
            ushort num28 = (ushort)(*i >> 16);
            uint num29 = *j & 0xFFFF;
            uint num30 = num28 ^ num29;
            *i ^= num30 << 16;
            *j ^= num30;
            uint num31 = ((*j >> 4) ^ *i) & 0xF0F0F0F;
            *j ^= num31 << 4;
            *i ^= num31;
        }

        protected static uint Ror_32(uint a, byte b)
        {
            return (a << 32 - b) | (a >> (int)b);
        }

        public unsafe static string CardCode(string cardno)
        {
            byte type = 1;
            uint num = default(uint);
            uint* i = &num;
            uint num2 = default(uint);
            uint* j = &num2;
            try
            {
                num = Convert.ToUInt32(cardno.Substring(0, 8), 16);
                num2 = Convert.ToUInt32(cardno.Substring(8, 8), 16);
            }
            catch (Exception)
            {
                return "";
            }
            Calc(i, j, 0);
            uint num3 = num;
            num = num2;
            num2 = num3;
            Calc(i, j, 1);
            uint num4 = num;
            num = num2;
            num2 = num4;
            Calc(i, j, 2);
            byte[] bytes = BitConverter.GetBytes(num);
            byte[] bytes2 = BitConverter.GetBytes(num2);
            type = bytes[0].Equals(0xe0) ? (byte)1 : (byte)2; //type
            byte[] array = new byte[8]; 
            Array.Copy(bytes, array, 4);
            Array.Copy(bytes2, 0, array, 4, 4);
            byte[] array2 = new byte[16];
            Array.Clear(array2, 0, array2.Length);
            int num5 = 0;
            do
            {
                uint num6 = (uint)(num5 / 5);
                array2[num6] = (byte)(((((uint)array[(uint)num5 >> 3] >> (int)(byte)(7 - (num5 & 7))) & 1) << (int)(num6 * 5) - num5 + 4) | array2[num6]);
                num5++;
            }
            while (num5 < 64);
            array2[13] = 1;
            array2[0] = (byte)(array2[0] ^ type); //add type
            int num7 = 1;
            do
            {
                array2[num7] = (byte)(array2[num7 - 1] ^ array2[num7]);
                num7++;
            }
            while (num7 <= 13);
            array2[14] = type; //add type
            uint num8 = 0u;
            int num9 = 0;
            do
            {
                byte num10 = array2[num9];
                int num11 = num9;
                num8 = (uint)((long)num10 * (long)(num11 - num11 / 3 * 3 + 1) + num8);
                num9++;
            }
            while (num9 <= 14);
            while (num8 != 31)
            {
                num8 = (num8 & 0x1F) + (num8 >> 5);
                if (num8 < 31)
                {
                    break;
                }
            }
            array2[15] = (byte)num8;
            string text = "";
            int num12 = 0;
            do
            {
                text += m_str[array2[num12]];
                num12++;
            }
            while (num12 <= 15);
            return text;
        }
    }

}
